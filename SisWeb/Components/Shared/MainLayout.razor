@inherits LayoutComponentBase
@inject SisWeb.Services.Session.ISessionHelper session
@inject IUriHelper uriHelper

<body class=" ">
    <!-- START TOPBAR -->
    <div class='page-topbar '>
        <div class='logo-area'>

        </div>
        <div class='quick-area'>

            <div class='float-left'>
                <ul class="info-menu right-links list-inline list-unstyled">
                    <li class="profile list-inline-item showopacity">
                        <a onclick="@GoBackUrl" data-toggle="dropdown" class="toggle">
                            <img src="/assets/images/arrow-back-1.png" alt="user-image" class="rounded-circle img-inline">
                        </a>
                    </li>
                    <li class="profile list-inline-item showopacity">
                        <a href="#" data-toggle="dropdown" class="toggle">
                            <img src="/assets/images/arrow-forward-1.png" alt="user-image" class="rounded-circle img-inline">
                        </a>
                    </li>
                </ul>
            </div>

            <div class='float-right'>
                <ul class="info-menu right-links list-inline list-unstyled">
                    <li class="profile list-inline-item showopacity">
                        <a href="#" data-toggle="dropdown" class="toggle">
                            <img src="/data/profile/profile.jpg" alt="user-image" class="rounded-circle img-inline">
                            <span>@session.AuthInformation.FullName &nbsp;<i class="fa fa-angle-down"></i></span>
                        </a>
                        <ul class="dropdown-menu profile animated fadeIn">
                            <li class="dropdown-item">
                                <a href="/login">
                                    <i class="fa fa-user"></i>
                                    Login
                                </a>
                            </li>
                            <li class="dropdown-item">
                                <a href="#settings">
                                    <i class="fa fa-wrench"></i>
                                    Settings
                                </a>
                            </li>
                            <li class="dropdown-item">
                                <a href="#help">
                                    <i class="fa fa-info"></i>
                                    Help
                                </a>
                            </li>
                            <li class="last dropdown-item">
                                <a href="ui-login.html">
                                    <i class="fa fa-lock"></i>
                                    Logout
                                </a>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>

    </div>
    <!-- END TOPBAR -->
    <!-- START CONTAINER -->
    <div class="page-container row-fluid container-fluid">

        <!-- SIDEBAR - START -->

        <div class="page-sidebar fixedscroll">

            <!-- MAIN MENU - START -->
            <div class="page-sidebar-wrapper" id="main-menu-wrapper">

                <!-- USER INFO - START -->
                <div class="profile-info row">

                    <div class="profile-image col-4">
                        <a href="ui-profile.html">
                            <img alt="" src="/data/profile/profile.jpg" class="img-fluid rounded-circle">
                        </a>
                    </div>

                    <div class="profile-details col-8">
                        <h3>
                            <a href="ui-profile.html">@session.AuthInformation.FullName</a>
                            <span class="profile-status online"></span>
                        </h3>
                    </div>

                </div>
                <!-- USER INFO - END -->
                @*Left menu  --------  Left menu *@
                @*Left menu  --------  Left menu *@

                <ul class='wraplist' style="height: auto;">

                    @if (session.Localities != null)
                    {
                        @foreach (var loc in session.Localities)
                        {
                            <li class="@IsDisabled(loc)">
                                <a onclick="@(e => ViewObjekt(@loc))" href="#" class="">
                                    <i class="fa fa-dashboard"></i>
                                    <span class="title">@loc.LocalityName</span>
                                </a>

                                @foreach (var obj in loc.Objekty)
                                {
                                    <ul class="sub-menu" style="display:block;">
                                        <li>
                                            <a class="" onclick="@(e => ViewObjekt(@loc))" href="#">
                                                @obj.objekt
                                            </a>
                                            <ul class="sub-menu" style="display:block;">
                                                <li>
                                                    <a class="" href="#" onclick="@(e => ViewPlovak(@loc.LocalityId.ToString(), obj.objekt_id.ToString() ))">@("Plováky")</a>
                                                </li>
                                            </ul>
                                        </li>
                                    </ul>
                                }
                            </li>
                        }
                    };

                </ul>
            </div>

        </div>
        <!--  SIDEBAR - END -->
        <!-- START CONTENT -->
        <section id="main-content" class=" ">
            <section class="wrapper main-wrapper row" style=''>
                <div class="clearfix"></div>
                <!-- MAIN CONTENT AREA STARTS -->
                @Body
                <!-- MAIN CONTENT AREA ENDS -->
            </section>
        </section>
        <!-- END CONTENT -->

        <div class="chatapi-windows ">

        </div>
    </div>
</body>



@functions {

    string IsDisabled(SisWeb.Services.Dto.Sis.LocalityModelDto model)
    {
        if (!model.IsLocal)
            return "disabled";

        return "";
    }

    void GoBackUrl()
    {
        if (!string.IsNullOrEmpty(session.BackUrl))
        {
            uriHelper.NavigateTo(session.BackUrl);
        }
    }

    void ViewObjekt(SisWeb.Services.Dto.Sis.LocalityModelDto model)
    {
        if (!model.IsLocal)
            return;

        session.NavigateModel.Action = "View";
        session.NavigateModel.LocalityId = model.LocalityId.ToString();
        session.NavigateModel.ObjektId = "";
        uriHelper.NavigateTo("/objekt");
    }

    void ViewPlovak(string localityId, string objektId)
    {
        session.NavigateModel.Action = "View";
        session.NavigateModel.LocalityId = localityId;
        session.NavigateModel.ObjektId = objektId;
        uriHelper.NavigateTo("/plovak");
    }
}